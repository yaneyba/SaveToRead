#:schema node_modules/wrangler/config-schema.json
name = "savetoread-api"
main = "src/index.ts"
compatibility_date = "2023-12-18"
compatibility_flags = ["nodejs_compat"]

# KV Namespaces
[[kv_namespaces]]
binding = "ARTICLES"
id = "c969a9ce60db4dc4aadae9a5ed038dcc"

[[kv_namespaces]]
binding = "USERS"
id = "5cd500cff447420987e259bd5e245597"

[[kv_namespaces]]
binding = "OAUTH_TOKENS"
id = "ffd14ea2556145b69bd1d69199c905a6"

[[kv_namespaces]]
binding = "SESSIONS"
id = "bc9f80b569bd4bb6b8fac012fcbd79f7"

# Durable Objects for rate limiting and real-time features
[[durable_objects.bindings]]
name = "RATE_LIMITER"
class_name = "RateLimiter"
script_name = "savetoread-api"

[[durable_objects.bindings]]
name = "READING_SESSION"
class_name = "ReadingSession"
script_name = "savetoread-api"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["RateLimiter", "ReadingSession"]

# Browser Rendering for PDF/HTML snapshots
[browser]
binding = "BROWSER"

# Environment variables (use .dev.vars for local development)
[env.production]
name = "savetoread-api-prod"

[env.staging]
name = "savetoread-api-staging"
